---
import type { Post } from '../lib/supabase';

interface Props {
	post: Post;
}

const { post } = Astro.props;
const formattedDate = new Date(post.created_at).toLocaleDateString('en-US', {
	year: 'numeric',
	month: 'short',
	day: '2-digit',
});
---

<article class="border-2 border-foreground p-4 flex flex-col gap-4 hover:shadow-[8px_8px_0px_rgba(255,0,255,0.5)] transition-all group">
	{post.image_url ? (
		<div class="aspect-video overflow-hidden border-2 border-foreground bg-neutral-900">
			<img
				src={post.image_url}
				alt={post.title}
				class="w-full h-full object-cover grayscale contrast-125 group-hover:grayscale-0 transition-all duration-500"
			/>
		</div>
	) : (
		<div class="aspect-video border-2 border-foreground bg-neutral-900 flex items-center justify-center font-mono text-xs text-neutral-500">
			[NO_IMAGE_AVAILABLE]
		</div>
	)}
	<div class="flex flex-col gap-2">
		<time class="font-mono text-sm text-accent-green">{formattedDate}</time>
		<h2 class="text-2xl font-bold leading-tight group-hover:text-accent-pink font-mono">
			<a href={`${import.meta.env.BASE_URL}/posts/${post.slug}`.replace(/\/+/g, '/')}>{post.title}</a>
		</h2>
		<p class="text-sm line-clamp-3 italic opacity-80">{post.summary}</p>
	</div>
	<div class="mt-auto pt-4 border-t border-foreground/30 flex flex-wrap gap-2 font-mono text-[10px] uppercase">
		<span class="bg-foreground text-background px-2 py-0.5">[WRITER: {post.ai_writer}]</span>
		<span class="border border-foreground px-2 py-0.5">[EDITOR: {post.ai_editor}]</span>
	</div>
</article>
